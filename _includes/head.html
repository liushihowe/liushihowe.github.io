<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {%- seo -%}
  <link rel="icon" type="image/x-icon" href="{{ '/assets/icons/Minimalist Website Icons in Color.ico' | relative_url }}">
  <link rel="stylesheet" href="{{ "/assets/main.css" | relative_url }}">
  {%- if site.use_local_fonts -%}
  <link rel="stylesheet" href="{{ "/assets/fonts/fonts.css" | relative_url }}">
  {%- endif -%}
  {%- comment %} jekyll-feed removed: feed_meta removed to simplify features. Add back if RSS is needed. {% endcomment %}
  {%- if jekyll.environment == 'production' and site.google_analytics -%}
    {%- include google-analytics.html -%}
  {%- endif -%}

  <!-- MathJax æ•°å­¦å…¬å¼æ”¯æŒ -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      options: {
        enableMenu: false            // ç¦ç”¨é»˜è®¤å³é”®èœå•
      },
      chtml: {
        scale: 1.0,
        displayAlign: 'center',
        displayIndent: '0'
      },
      startup: {
        ready: () => {
          MathJax.startup.defaultReady();
          MathJax.startup.promise.then(() => {
            // ä¸ºæ‰€æœ‰å…¬å¼æ·»åŠ ç‚¹å‡»æ”¾å¤§å’Œå¤åˆ¶åŠŸèƒ½
            document.querySelectorAll('mjx-container').forEach(container => {
              container.style.cursor = 'pointer';
              container.addEventListener('click', function(e) {
                showFormulaModal(this);
              });
            });
          });
        }
      }
    };

    // æ˜¾ç¤ºå…¬å¼æ”¾å¤§å¼¹çª—
    function showFormulaModal(formulaElement) {
      // åˆ›å»ºé®ç½©å±‚
      const overlay = document.createElement('div');
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        cursor: pointer;
      `;

      // åˆ›å»ºå†…å®¹å®¹å™¨ï¼ˆä½¿ç”¨ --radius-md: 8pxï¼‰
      const modal = document.createElement('div');
      modal.style.cssText = `
        background: #ffffff;
        padding: 40px;
        border-radius: 8px;
        border: 1px solid #e3e6eb;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
        max-width: 90%;
        max-height: 90%;
        overflow: auto;
        position: relative;
        cursor: default;
        display: flex;
        flex-direction: column;
        align-items: center;
      `;

      // åˆ›å»ºå…¬å¼å®¹å™¨ï¼ˆéœ€è¦ relative å®šä½æ¥æ”¾ç½®å¤åˆ¶æŒ‰é’®ï¼‰
      const formulaContainer = document.createElement('div');
      formulaContainer.style.cssText = `
        position: relative;
        width: 100%;
        background: #f5f7fa;
        padding: 24px;
        padding-top: 48px;
        border: 1px solid #e3e6eb;
        border-radius: 8px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04), 0 2px 4px rgba(0, 0, 0, 0.04);
        box-sizing: border-box;
        display: flex;
        justify-content: center;
      `;

      // å…‹éš†å…¬å¼å¹¶æ”¾å¤§
      const formulaClone = formulaElement.cloneNode(true);
      formulaClone.style.cssText = `
        font-size: 200%;
      `;

      // è·å–å…¬å¼çš„ LaTeX æºç 
      const latex = formulaElement.getAttribute('data-mjx-texclass') 
        ? getLatexFromElement(formulaElement)
        : formulaElement.textContent;

      // åˆ›å»ºå¤åˆ¶æŒ‰é’®ï¼ˆå›¾æ ‡æŒ‰é’®ï¼Œæ”¾åœ¨å³ä¸Šè§’ï¼‰
      const copyBtn = document.createElement('button');
      copyBtn.textContent = 'ğŸ“‹';
      copyBtn.title = 'å¤åˆ¶å…¬å¼';
      copyBtn.style.cssText = `
        position: absolute;
        top: 12px;
        right: 12px;
        background: #eef2f6;
        color: #1d1f23;
        border: 1px solid #d5dbe3;
        padding: 8px;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.18s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8), 0 1px 1px rgba(0, 0, 0, 0.05);
        line-height: 1;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
      `;
      copyBtn.onmouseover = () => {
        copyBtn.style.background = '#f0f2f5';
        copyBtn.style.borderColor = '#e3e6eb';
        copyBtn.style.transform = 'scale(1.1)';
      };
      copyBtn.onmouseout = () => {
        copyBtn.style.background = '#eef2f6';
        copyBtn.style.borderColor = '#d5dbe3';
        copyBtn.style.transform = 'scale(1)';
      };
      copyBtn.onclick = (e) => {
        e.stopPropagation();
        copyToClipboard(formulaElement.textContent);
        copyBtn.textContent = 'âœ…';
        setTimeout(() => {
          copyBtn.textContent = 'ğŸ“‹';
        }, 2000);
      };

      // ç»„è£…å¼¹çª—
      formulaContainer.appendChild(copyBtn);
      formulaContainer.appendChild(formulaClone);
      modal.appendChild(formulaContainer);
      overlay.appendChild(modal);

      // ç‚¹å‡»é®ç½©å…³é—­
      overlay.onclick = (e) => {
        if (e.target === overlay) {
          document.body.removeChild(overlay);
        }
      };

      // é˜»æ­¢å¼¹çª—å†…éƒ¨ç‚¹å‡»å†’æ³¡
      modal.onclick = (e) => e.stopPropagation();

      document.body.appendChild(overlay);
    }

    // å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard(text) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text);
      } else {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
      }
    }

    // æå– LaTeX æºç ï¼ˆå°è¯•ï¼‰
    function getLatexFromElement(element) {
      return element.textContent;
    }
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  
</head>
